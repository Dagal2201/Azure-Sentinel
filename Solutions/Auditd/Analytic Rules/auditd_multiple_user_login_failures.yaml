id: 42dd3c33-833a-4400-a7c6-39515582120a
name: AuditD - Multiple user login failures
description: |
  'This query is designed to detect repeated failed login attempts by users'
severity: Low
status: Available
requiredDataConnectors:
- connectorId: AuditDSyslog
  dataTypes:
  - Syslog
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
- InitialAccess
relevantTechniques:
- T1189
query: |-
  let failedAttempts = 10;
  let keys = dynamic(["session_faillog", "session_btmp"]);
  ASim_LinuxAuditdSyslog_V01(disabled=false)
      | where key in (keys)
      | summarize FailedLoginsCount = count(), FailedLoginAt=min(TimeGenerated) by Dvc
      | where FailedLoginsCount >= failedAttempts
      | project FailedLoginAt, Dvc, FailedLoginsCount
      | order by FailedLoginsCount;
entityMappings:
- entityType: IP
  fieldMappings:
  - identifier: Address
    columnName: IPCustomEntity
version: 1.0.0
kind: Scheduled
